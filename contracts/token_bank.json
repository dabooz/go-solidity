{"info":{"language":"Solidity","languageVersion":"0.3.1","abiDefinition":[{"inputs":[{"type":"address","name":"_addr"}],"type":"function","constant":true,"name":"account_balance_by_addr","outputs":[{"type":"uint256","name":"balance"}]},{"inputs":[{"type":"address","name":"_proposer"},{"type":"address","name":"_cp"},{"type":"address","name":"_contract"}],"type":"function","constant":true,"name":"get_counterparty_accepted","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[{"type":"address","name":"_proposer"},{"type":"address","name":"_cp"},{"type":"address","name":"_contract"}],"type":"function","constant":true,"name":"get_proposer_accepted","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[],"type":"function","constant":true,"name":"loan_balance","outputs":[{"type":"uint256","name":"r"}]},{"inputs":[{"type":"address","name":"_cp"},{"type":"address","name":"_contract"},{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"make_payment","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[],"type":"function","constant":false,"name":"kill","outputs":[]},{"inputs":[{"type":"address","name":"_cp"},{"type":"address","name":"_contract"},{"type":"bool","name":"_vote"}],"type":"function","constant":false,"name":"proposer_vote","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[],"type":"function","constant":true,"name":"get_minter","outputs":[{"type":"address","name":"r"}]},{"inputs":[{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"repay_loan","outputs":[{"type":"bool","name":"r"}]},{"inputs":[{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"increase_loan","outputs":[{"type":"bool","name":"r"}]},{"inputs":[{"type":"address","name":"_addr"}],"type":"function","constant":true,"name":"loan_balance_by_addr","outputs":[{"type":"uint256","name":"balance"}]},{"inputs":[{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"mint","outputs":[]},{"inputs":[{"type":"address","name":"_proposer"},{"type":"address","name":"_cp"},{"type":"address","name":"_contract"}],"type":"function","constant":true,"name":"get_escrow_amount","outputs":[{"type":"uint256","name":"rv"}]},{"inputs":[{"type":"address","name":"_receiver"},{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"transfer","outputs":[{"type":"bool","name":"r"}]},{"inputs":[],"type":"function","constant":true,"name":"get_total_currency","outputs":[{"type":"uint256","name":"r"}]},{"inputs":[{"type":"address","name":"_proposer"},{"type":"address","name":"_contract"},{"type":"bool","name":"_vote"}],"type":"function","constant":false,"name":"counter_party_vote","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"obtain_loan","outputs":[{"type":"bool","name":"r"}]},{"inputs":[],"type":"function","constant":true,"name":"account_balance","outputs":[{"type":"uint256","name":"balance"}]},{"inputs":[{"type":"address","name":"_proposer"},{"type":"address","name":"_cp"},{"type":"address","name":"_contract"}],"type":"function","constant":true,"name":"get_agreement_cancelled","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[{"type":"address","name":"_proposer"},{"type":"address","name":"_cp"},{"type":"address","name":"_contract"},{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"cancel_escrow","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[{"type":"address","name":"_cp"},{"type":"address","name":"_contract"},{"type":"uint256","name":"_amount"}],"type":"function","constant":false,"name":"create_escrow","outputs":[{"type":"bool","name":"rv"}]},{"inputs":[],"type":"constructor","constant":false,"name":"","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"owner"},{"type":"address","name":"_from"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"Mint","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"ObtainLoan","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"ExtendLoan","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"RepayLoan","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"Transfer","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"address","name":"_contract"},{"type":"uint256","name":"_amount"}],"type":"event","constant":false,"name":"NewProposal","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"address","name":"_contract"}],"type":"event","constant":false,"name":"CancelProposal","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"address","name":"_contract"}],"type":"event","constant":false,"name":"CounterpartyAccepted","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"address","name":"_contract"}],"type":"event","constant":false,"name":"ProposerVerified","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"address","name":"_contract"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"ProposerPaid","outputs":null},{"inputs":[{"type":"uint256","name":"_event_code"},{"type":"address","name":"_from"},{"type":"address","name":"_to"},{"type":"address","name":"_contract"},{"type":"uint256","name":"_value"}],"type":"event","constant":false,"name":"EscrowRefund","outputs":null}],"compilerVersion":"0.3.1","developerDoc":{"methods":{}},"userDoc":{"methods":{}},"source":"contract authorized_caller {function get_owner() constant returns (address r) {}}contract container_executor {function cancel_container(uint _amount) returns (bool r) {}}contract token_bank {address minter;uint total_currency;mapping (address =\u003e uint) balances;mapping (address =\u003e uint) loans;uint constant loan_limit = 100000000;struct proposal {bool proposer_vote;bool counter_party_vote;bool cancelled;uint amount;}struct shared_contract {mapping (address =\u003e proposal) proposals;}struct counter_party {mapping (address =\u003e shared_contract) counter_parties;}mapping (address =\u003e counter_party) escrow;enum event_codes {mint,loan_created,loan_extended,loan_repaid,transfer,escrow_created,escrow_cancelled,escrow_counterparty_accepted,escrow_proposer_accepted,escrow_proposer_paid,escrow_refunded}event Mint(uint indexed _event_code, address indexed owner, address indexed _from, uint indexed _value) anonymous;event ObtainLoan(uint indexed _event_code, address indexed _from, uint indexed _value) anonymous;event ExtendLoan(uint indexed _event_code, address indexed _from, uint indexed _value) anonymous;event RepayLoan(uint indexed _event_code, address indexed _from, uint indexed _value) anonymous;event Transfer(uint indexed _event_code, address indexed _from, address indexed _to, uint indexed _value) anonymous;event NewProposal(uint indexed _event_code, address indexed _from, address indexed _to, address indexed _contract, uint _amount) anonymous;event CancelProposal(uint indexed _event_code, address indexed _from, address indexed _to, address indexed _contract) anonymous;event CounterpartyAccepted(uint indexed _event_code, address indexed _from, address indexed _to, address indexed _contract) anonymous;event ProposerVerified(uint indexed _event_code, address indexed _from, address indexed _to, address indexed _contract) anonymous;event ProposerPaid(uint indexed _event_code, address indexed _from, address indexed _to, address indexed _contract, uint _value) anonymous;event EscrowRefund(uint indexed _event_code, address indexed _from, address indexed _to, address indexed _contract, uint _value) anonymous;function token_bank() {minter = msg.sender;total_currency = 1000000000000000000000;}function transfer(address _receiver, uint _amount) returns (bool r) {if (balances[tx.origin] \u003c _amount) return false;balances[tx.origin] -= _amount;balances[_receiver] += _amount;Transfer(uint(event_codes.transfer), tx.origin, _receiver, _amount);return true;}function account_balance() constant returns (uint balance) {return balances[tx.origin];}function account_balance_by_addr(address _addr) constant returns (uint balance) {if (tx.origin == minter || tx.origin == _addr) {return balances[_addr];} else {return 0;}}function hasAmount(address _addr, uint _amount) internal constant returns (bool res) {return balances[_addr]\u003e=_amount;}function obtain_loan(uint _amount) returns (bool r) {if (exceeds_loan_limits(_amount)) return false;var existing_loan = loans[tx.origin];if (existing_loan != 0) return false;loans[tx.origin] = _amount;total_currency -= _amount;balances[tx.origin] += _amount;ObtainLoan(uint(event_codes.loan_created), tx.origin, _amount);return true;}function increase_loan(uint _amount) returns (bool r) {if (exceeds_loan_limits(_amount)) return false;var existing_loan = loans[tx.origin];if (existing_loan == 0) return false;loans[tx.origin] += _amount;total_currency -= _amount;balances[tx.origin] += _amount;ExtendLoan(uint(event_codes.loan_extended), tx.origin, _amount);return true;}function repay_loan(uint _amount) returns (bool r) {if (balances[tx.origin] \u003c _amount) return false;total_currency += _amount;loans[tx.origin] -= _amount;balances[tx.origin] -= _amount;RepayLoan(uint(event_codes.loan_repaid), tx.origin, _amount);return true;}function loan_balance() constant returns (uint r) {return loans[tx.origin];}function loan_balance_by_addr(address _addr) constant returns (uint balance) {if (tx.origin == minter || tx.origin == _addr) {return loans[_addr];} else {return 0;}}function exceeds_loan_limits(uint _amount) internal constant returns (bool r) {if (_amount \u003e total_currency || _amount \u003e loan_limit) {return true;}return false;}function create_escrow(address _cp, address _contract, uint _amount) returns (bool rv) {if (_amount \u003e 0 \u0026\u0026 hasAmount(tx.origin,_amount)) {var prop = escrow[tx.origin].counter_parties[_cp].proposals[_contract];if (prop.amount == 0) {escrow[tx.origin].counter_parties[_cp].proposals[_contract] = proposal({proposer_vote:false,counter_party_vote:false,cancelled:false,amount:_amount});balances[tx.origin] -= _amount;NewProposal(uint(event_codes.escrow_created), tx.origin, _cp, _contract, _amount);return true;} else {return false;}} else {return false;}}function counter_party_vote(address _proposer, address _contract, bool _vote) returns (bool rv) {var prop = escrow[_proposer].counter_parties[tx.origin].proposals[_contract];if (prop.amount != 0) {prop.counter_party_vote = _vote;CounterpartyAccepted(uint(event_codes.escrow_counterparty_accepted), _proposer, tx.origin, _contract);return true;} else {return false;}}function proposer_vote(address _cp, address _contract, bool _vote) returns (bool rv) {var prop = escrow[tx.origin].counter_parties[_cp].proposals[_contract];if (prop.amount != 0) {prop.proposer_vote = _vote;ProposerVerified(uint(event_codes.escrow_proposer_accepted), tx.origin, _cp, _contract);return true;} else {return false;}}function make_payment(address _cp, address _contract, uint _amount) returns (bool rv) {var prop = escrow[tx.origin].counter_parties[_cp].proposals[_contract];if (prop.amount != 0 \u0026\u0026 prop.cancelled == false \u0026\u0026 prop.proposer_vote == true \u0026\u0026 prop.counter_party_vote == true) {var pay = _amount;if (_amount \u003e prop.amount) {pay = prop.amount;}balances[_cp] += pay;ProposerPaid(uint(event_codes.escrow_proposer_paid), tx.origin, _cp, _contract, _amount);var remains = prop.amount - pay;if (hasAmount(tx.origin, pay)) {balances[tx.origin] -= pay;} else {balances[tx.origin] += remains;var device_contract = container_executor(_contract);device_contract.cancel_container(pay);}return true;} else {return false;}}function cancel_escrow(address _proposer, address _cp, address _contract, uint _amount) returns (bool rv) {if (tx.origin != _proposer \u0026\u0026 tx.origin != _cp) return false;var prop = escrow[_proposer].counter_parties[_cp].proposals[_contract];if (tx.origin == _proposer) {if (prop.amount != 0 \u0026\u0026 (prop.proposer_vote == false || prop.counter_party_vote == false)) {balances[_proposer] += prop.amount;CancelProposal(uint(event_codes.escrow_cancelled), _proposer, _cp, _contract);EscrowRefund(uint(event_codes.escrow_refunded), _proposer, _cp, _contract, prop.amount);delete escrow[_proposer].counter_parties[_cp].proposals[_contract];} else {if (prop.amount != 0 \u0026\u0026 _amount \u003e 0) {var pay = _amount;if (_amount \u003e prop.amount) {pay = prop.amount;}balances[_cp] += pay;ProposerPaid(uint(event_codes.escrow_proposer_paid), _proposer, _cp, _contract, pay);CancelProposal(uint(event_codes.escrow_cancelled), _proposer, _cp, _contract);var remains = prop.amount - pay;balances[tx.origin] += remains;EscrowRefund(uint(event_codes.escrow_refunded), _proposer, _cp, _contract, remains);delete escrow[_proposer].counter_parties[_cp].proposals[_contract];} else {return false;}}} else {if (tx.origin == _cp) {prop.cancelled = true;if (prop.amount != 0 \u0026\u0026 (prop.proposer_vote == false || prop.counter_party_vote == false)) {balances[_proposer] += prop.amount;EscrowRefund(uint(event_codes.escrow_refunded), _proposer, _cp, _contract, prop.amount);CancelProposal(uint(event_codes.escrow_cancelled), _proposer, _cp, _contract);delete escrow[_proposer].counter_parties[_cp].proposals[_contract];}}}return true;}function get_escrow_amount(address _proposer, address _cp, address _contract) constant returns (uint rv) {if (tx.origin == _proposer || tx.origin == _cp || tx.origin == minter) {var prop = escrow[_proposer].counter_parties[_cp].proposals[_contract];return prop.amount;} else {return 0;}}function get_counterparty_accepted(address _proposer, address _cp, address _contract) constant returns (bool rv) {var prop = escrow[_proposer].counter_parties[_cp].proposals[_contract];if (prop.amount != 0) {return prop.counter_party_vote;}return false;}function get_proposer_accepted(address _proposer, address _cp, address _contract) constant returns (bool rv) {var prop = escrow[_proposer].counter_parties[_cp].proposals[_contract];if (prop.amount != 0) {return prop.proposer_vote;}return false;}function get_agreement_cancelled(address _proposer, address _cp, address _contract) constant returns (bool rv) {var prop = escrow[_proposer].counter_parties[_cp].proposals[_contract];if (prop.amount != 0) {return prop.cancelled;}return false;}function mint(uint _amount) {authorized_caller sender = authorized_caller(msg.sender);address sender_owner = sender.get_owner();if (tx.origin == minter || sender_owner == minter) {total_currency += _amount;Mint(uint(event_codes.mint), minter, sender_owner, _amount);}}function get_total_currency() constant returns (uint r) {authorized_caller sender = authorized_caller(msg.sender);address sender_owner = sender.get_owner();if (tx.origin == minter || sender_owner == minter) {return total_currency;}return 0;}function get_minter() constant returns (address r) {return minter;}function kill() {if (msg.sender == minter) suicide(minter);}}"},"code":"0x606060405260008054600160a060020a03191633179055683635c9adc5dea00000600155610fae806100316000396000f3606060405236156100fb5760e060020a60003504630cb3129a81146100fd57806313f30197146101585780632ffe31fc146101b157806336a8752414610205578063375c12001461022557806341c0e1b51461033357806343b9ea0b1461035c57806365ef7750146103d3578063729c7e83146103e75780638b775246146104135780638dc50dc414610445578063a0712d68146104a0578063a6d6b7c514610545578063a9059cbb146105e2578063b3292dd014610611578063b700612314610696578063bacbbc3714610712578063c08b939914610725578063c7dde7f914610746578063d9638508146107a0578063ee44a6d3146107f9575b005b61081e60043560008054600160a060020a0390811632919091161480610134575081600160a060020a031632600160a060020a0316145b156108915750600160a060020a038116600090815260026020526040902054610895565b61081e600435602435604435600160a060020a03838116600090815260046020908152604080832086851684528252808320938516835292905290812060018101548214610b8c578054610100900460ff169150610b91565b61081e600435602435604435600160a060020a03838116600090815260046020908152604080832086851684528252808320938516835292905290812060018101548214610b8c57805460ff169150610b91565b61081e600160a060020a0332166000908152600360205260409020545b90565b61081e600435602435604435600160a060020a033281166000908152600460209081526040808320878516845282528083209386168352929052908120600181015482908190819081148015906102855750835462010000900460ff1681145b80156102955750835460ff166001145b80156102aa57508354610100900460ff166001145b15610b995760018401548693508311156102c657600184015492505b600160a060020a0388811660008181526002602090815260409182902080548801905581518a815291518b851694321692600992908290030190a460018401548390039150610ba932845b600160a060020a0382166000908152600260205260409020548190101561088b565b6100fb600054600160a060020a03908116339091161415610fac57600054600160a060020a0316ff5b61081e600435602435604435600160a060020a03328116600090815260046020908152604080832087851684528252808320938616835292905290812060018101548214610b8c57805460ff191683178155604051600160a060020a0385811691878216913216906008908690a460019150610b91565b610830600054600160a060020a0316610222565b61081e600435600160a060020a0332166000908152600260205260408120548290101561099957610895565b61081e60043560006000610918835b60015460009082118061043857506305f5e10082115b1561089157506001610895565b61081e60043560008054600160a060020a039081163291909116148061047c575081600160a060020a031632600160a060020a0316145b156108915750600160a060020a038116600090815260036020526040902054610895565b6100fb6004356000600033915081600160a060020a0316630ac298dc6040518160e060020a0281526004018090506020604051808303816000876161da5a03f115610002575050604051519154600160a060020a039081163291909116149050806105185750600054600160a060020a038281169116145b15610540576001805484019055600080546040518592600160a060020a038581169316918190a45b505050565b61081e6004356024356044356000600084600160a060020a031632600160a060020a03161480610586575083600160a060020a031632600160a060020a0316145b806105a15750600054600160a060020a039081163291909116145b15610b8c575050600160a060020a03838116600090815260046020908152604080832086851684528252808320938516835292905220600181015490610b91565b61081e600435602435600160a060020a0332166000908152600260205260408120548290101561084d5761088b565b61081e60006000600033915081600160a060020a0316630ac298dc6040518160e060020a0281526004018090506020604051808303816000876161da5a03f115610002575050604051519154600160a060020a0390811632919091161490508061068757508254600160a060020a038281169116145b15610fa2576001549250610fa7565b61081e600435602435604435600160a060020a03838116600090815260046020908152604080832032851684528252808320938616835292905290812060018101548214610b8c57805461ff0019166101008402178155604051600160a060020a0380861691328216918816906007908690a460019150610b91565b61081e600435600060006108e083610422565b61081e600160a060020a033216600090815260026020526040902054610222565b61081e600435602435604435600160a060020a03838116600090815260046020908152604080832086851684528252808320938516835292905290812060018101548214610b8c57805462010000900460ff169150610b91565b61081e600435602435604435606435600060006000600087600160a060020a031632600160a060020a0316141580156107eb575086600160a060020a031632600160a060020a031614155b15610c685760009350610c5d565b61081e600435602435604435600060006000831180156109e057506109e03284610311565b60408051918252519081900360200190f35b60408051600160a060020a03929092168252519081900360200190f35b600160a060020a0332811660008181526002602052604080822080548790039055928616808252838220805487019055925185939291600491a45060015b92915050565b5060005b919050565b600160a060020a033216600081815260036020908152604080832087905560018054889003815560029092528083208054880190555186939290a3600191505b50919050565b156108ee57600091506108da565b50600160a060020a03321660009081526003602052604081205490811461089a57600091506108da565b1561092657600091506108da565b50600160a060020a0332166000908152600360205260408120549081141561095157600091506108da565b600160a060020a03321660008181526003602090815260408083208054880190556001805488900390556002918290528083208054880190555186939290a3600191506108da565b6001805483019055600160a060020a0332166000818152600360208181526040808420805488900390556002909152808320805487900390555185939290a3506001610895565b15610b8c5750600160a060020a033281166000908152600460209081526040808320888516845282528083209387168352929052908120600181015490911415610b8c57608060405190810160405280600081526020016000815260200160008152602001848152602001506004600050600032600160a060020a03168152602001908152602001600020600050600001600050600087600160a060020a03168152602001908152602001600020600050600001600050600086600160a060020a0316815260200190815260200160002060005060008201518160000160006101000a81548160ff0219169083021790555060208201518160000160016101000a81548160ff0219169083021790555060408201518160000160026101000a81548160ff0219169083021790555060608201518160010160005055905050826002600050600032600160a060020a0316815260200190815260200160002060008282825054039250508190555083600160a060020a031685600160a060020a031632600160a060020a03166005866040518082815260200191505060405180910390a460019150610b91565b600091505b509392505050565b600094505b505050509392505050565b15610bd257600160a060020a033216600090815260026020526040902080548490039055610c4f565b50600160a060020a03328116600090815260026020908152604080832080548601905580517f781dba260000000000000000000000000000000000000000000000000000000081526004810187905290518a9485169363781dba26936024848101949193929183900301908290876161da5a03f115610002575050505b60019450610b9e565b600093505b505050949350505050565b600160a060020a0388811660008181526004602090815260408083208c8616845282528083208b861684529091529020945032919091161415610d7c576001830154600014801590610cd15750825460ff1660001480610cd157508254610100900460ff166000145b15610e85576001830154600160a060020a03898116600081815260026020526040808220805495909501909455925189831693928b1692600691a460408051600185015481529051600160a060020a03888116928a821692918c1691600a9181900360200190a4600160a060020a0388811660009081526004602090815260408083208b851684528252808320938a168352929052908120805462ffffff1916815560010155610f9d565b86600160a060020a031632600160a060020a03161415610e7c57825462ff00001916620100001783556001830154600014801590610dd15750825460ff1660001480610dd157508254610100900460ff166000145b15610e7c57600183018054600160a060020a038a81166000818152600260209081526040918290208054959095019094559354845190815293518a831694928c16939192600a92908290030190a4604051600160a060020a0387811691898216918b1690600690600090a4600160a060020a0388811660009081526004602090815260408083208b851684528252808320938a168352929052908120805462ffffff19168155600101555b60019350610c5d565b6001830154600014801590610e9a5750600085115b15610c58576001830154859250821115610eb657600183015491505b600160a060020a03878116600081815260026020908152604091829020805487019055815186815291518a8516948d1692600992908290030190a4604051600160a060020a0387811691898216918b1690600690600090a450604080516001840154600160a060020a0332811660009081526002602090815290859020805493879003938401905582845293519193898216938b831693928d1692600a929181900390910190a4600160a060020a0388811660009081526004602090815260408083208b851684528252808320938a168352929052908120805462ffffff19168155600101555b610e7c565b600092505b505090565b56"}